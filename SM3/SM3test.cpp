
#include <cppunit/config/SourcePrefix.h>
#include "SM3test.h"
#include "SM3.h"
#include  <string.h>

int Decrease(const char *pMinuend, const char *pSubtrahend, char **ppResult);


 //注册测试套到CppUnit
CPPUNIT_TEST_SUITE_REGISTRATION( CExampleTest );

// 测试用例实现示例

// SetUp: 在每个用例前执行一次
void CExampleTest::setUp()
{
    
}

// tearDown: 在每个用例后执行一次
void CExampleTest::tearDown()
{
    
}


// 用例1:
void CExampleTest::TestCase01()
{
	char pIn[65] = {0x61,0x62,0x63,0x80,0x00,0x00,0x00,0x00,
					0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
					0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
					0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
					0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
					0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
					0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
					0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x18,0x00};
	const char pExpect[33]={0x66,0xc7,0xf0,0xf4,0x62,0xee,0xed,0xd9,
							0xd1,0xf2,0xd4,0x6b,0xdc,0x10,0xe4,0xe2,
							0x41,0x67,0xc4,0x87,0x5c,0xf2,0xf7,0xa2,
							0x29,0x7d,0xa0,0x2b,0x8f,0x4b,0xa8,0xe0,0x00};
    char * pOut = new char[33];
	memset(pOut,0,33);
	int len=64;
    SM3(pIn, pOut,len);
    CPPUNIT_ASSERT(pOut != NULL);
    CPPUNIT_ASSERT(strcmp(pExpect, pOut) == 0);
    delete []pOut;
}
